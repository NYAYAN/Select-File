// Author : Nurullah YAYAN
// Github: https://github.com/NYAYAN/Select-File
window,"undefined"==typeof NY?NY={FilePlugin:{config:{},files:[]}}:NY.FilePlugin={config:{},files:[]},NY.FilePlugin.config.byteUnits=[" kB"," MB"," GB"," TB","PB","EB","ZB","YB"],NY.FilePlugin.config.icons={cancel:'<svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 512.001 512.001" style="width:18px; height:18px;" xml:space="preserve"> <path d="M405.6,69.6C360.7,24.7,301.1,0,237.6,0s-123.1,24.7-168,69.6S0,174.1,0,237.6s24.7,123.1,69.6,168s104.5,69.6,168,69.6s123.1-24.7,168-69.6s69.6-104.5,69.6-168S450.5,114.5,405.6,69.6z M386.5,386.5c-39.8,39.8-92.7,61.7-148.9,61.7s-109.1-21.9-148.9-61.7c-82.1-82.1-82.1-215.7,0-297.8C128.5,48.9,181.4,27,237.6,27s109.1,21.9,148.9,61.7C468.6,170.8,468.6,304.4,386.5,386.5z"/> <path d="M342.3,132.9c-5.3-5.3-13.8-5.3-19.1,0l-85.6,85.6L152,132.9c-5.3-5.3-13.8-5.3-19.1,0c-5.3,5.3-5.3,13.8,0,19.1l85.6,85.6l-85.6,85.6c-5.3,5.3-5.3,13.8,0,19.1c2.6,2.6,6.1,4,9.5,4s6.9-1.3,9.5-4l85.6-85.6l85.6,85.6c2.6,2.6,6.1,4,9.5,4c3.5,0,6.9-1.3,9.5-4c5.3-5.3,5.3-13.8,0-19.1l-85.4-85.6l85.6-85.6C347.6,146.7,347.6,138.2,342.3,132.9z"/> </svg>'},NY.FilePlugin.config.messages={fileSizeErrorMessage:"Tekli dosya seçim boyutunu aştınız",totalSizeErrorMessage:"Maximum yükleyebileceğiniz boyutu aştınız",extensionErrorMessage:"Seçtiğiniz dosyaların uzantısı desteklenmemektedir."},window.onload=function(){var e=document.querySelectorAll(".ny-file"),i=100001;function t(e){var i=document.querySelectorAll("ul.selectedFiles[data-key='"+e.key+"']");0!=i.length&&(function(e){var i=document.querySelectorAll("ul.errors[data-key='"+e.key+"']");if(e.errors.extension||e.errors.fileSize||e.errors.totalFilesSize){var t=document.querySelectorAll("input.ny-file[data-key='"+e.key+"']");i=0==i.length?document.createElement("ul"):i[0];var l="";i.classList.add("errors"),i.dataset.key=e.key,e.errors.extension&&(l+="<li>"+NY.FilePlugin.config.messages.extensionErrorMessage+"</li>"),e.errors.fileSize&&(l+="<li>"+NY.FilePlugin.config.messages.fileSizeErrorMessage+"</li>"),e.errors.totalFilesSize&&(l+="<li>"+NY.FilePlugin.config.messages.totalSizeErrorMessage+"</li>"),i.innerHTML=l,(t=t[0]).parentNode.insertBefore(i,t.nextSibling)}else i.length>0&&(i=i[0]).parentNode.removeChild(i)}(e),(i=i[0]).innerHTML="",e.files.forEach(function(s,n){var a=document.createElement("span");a.classList.add("remove"),a.innerHTML=NY.FilePlugin.config.icons.cancel,a.dataset.index=n,a.dataset.key=e.key,a.addEventListener("click",function(e){var i=this.dataset.key,s=this.dataset.index,n=NY.FilePlugin.files.filter(function(e){if(e.key==i)return e.files.splice(s,1),e});n.length>0&&(l(n=n[0]),t(n))});var r=document.createElement("span");r.classList.add("name"),r.innerText=s.name;var o=document.createElement("span");o.classList.add("size"),o.innerText=function(e){var i=-1;do{e/=1024,i++}while(e>1024);return Math.max(e,.1).toFixed(2)+NY.FilePlugin.config.byteUnits[i]}(s.size);var d=document.createElement("li");0==s.isValid?d.classList.add("danger"):d.classList.add("success"),d.appendChild(r),d.appendChild(o),d.appendChild(a),i.appendChild(d)}))}function l(e){var i={extension:!1,fileSize:!1,totalFilesSize:!1},t=0;e.files.forEach(function(l){if(l.isValid=!0,null!=e.size&&e.size<l.size&&(l.isValid=!1,i.fileSize=!0),void 0!==e.mimeTypes&&1==l.isValid){var s=l.name.split(".");if(s.length>0){var n="."+s[s.length-1];-1==e.mimeTypes.indexOf(n)&&(l.isValid=!1)}else l.isValid=!1}0==l.isValid&&1!=i.extension&&(i.extension=!0),t+=l.size}),null!=e.totalSize&&(i.totalFilesSize=e.totalSize<t),NY.FilePlugin.files[e.index].errors=i}(e=Array.prototype.slice.call(e)).forEach(function(e,s){var n;n=e,Object.defineProperty(n,"filesIsValid",{value:function(){var e=NY.FilePlugin.files.filter(function(e){return e.key==n.dataset.key});return!(e.length>0&&((e=e[0]).errors.extension||e.errors.fileSize||e.errors.totalFilesSize))},writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(n,"filesData",{value:function(){var e=NY.FilePlugin.files.filter(function(e){return e.key==n.dataset.key});return e.length>0?e[0]:null},writable:!1,enumerable:!1,configurable:!1}),e.value="",e.dataset.key=i;var a={index:s,key:i++,type:e.dataset.type,size:void 0,totalSize:void 0,mimeTypes:void 0,errors:{extension:!1,fileSize:!1,totalFilesSize:!1}};if(void 0!==e.dataset.size){var r=parseInt(e.dataset.size);r&&(a.size=r)}if(void 0!==e.dataset.totalSize){var o=parseInt(e.dataset.totalSize);o&&(a.totalSize=o)}void 0!==e.accept&&(a.mimeTypes=e.accept.split(",")),void 0!==e.dataset.fileSizeErrorMessage&&(NY.FilePlugin.config.messages.fileSizeErrorMessage=e.dataset.fileSizeErrorMessage),void 0!==e.dataset.totalSizeErrorMessage&&(NY.FilePlugin.config.messages.totalSizeErrorMessage=e.dataset.totalSizeErrorMessage),void 0!==e.dataset.extensionErrorMessage&&(NY.FilePlugin.config.messages.extensionErrorMessage=e.dataset.extensionErrorMessage),NY.FilePlugin.files.push(a),e.addEventListener("change",function(e){var i,s,n;e.preventDefault(),i=this,s=this.files,0==(n=document.querySelectorAll('ul.selectedFiles[data-key="'+i.dataset.key+'"]')).length&&((n=document.createElement("ul")).classList.add("selectedFiles"),n.dataset.key=i.dataset.key,i.parentNode.appendChild(n)),function(e,i){var s=NY.FilePlugin.files.filter(function(i){return i.key==e});0!=s.length&&(void 0!==(s=s[0]).files&&"append"===s.type||(s.files=[],NY.FilePlugin.files[s.index].files=[]),(i=Array.prototype.slice.call(i)).forEach(function(e){NY.FilePlugin.files[s.index].files.push(e)}),l(s),t(NY.FilePlugin.files[s.index]))}(i.dataset.key,s),this.value=""})})};